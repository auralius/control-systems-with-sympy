<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Digital PID Control - Part 2 &#8212; Control Systems with Sympy</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/traditional.css?v=608ddc6c" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"HTML-CSS": {"matchFontHeight": true, "scale": 50}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Digital Low-Pass Filter" href="digital-filter.html" />
    <link rel="prev" title="Digital PID Control - Part 1" href="digital-pid.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="digital-filter.html" title="Digital Low-Pass Filter"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="digital-pid.html" title="Digital PID Control - Part 1"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="intro.html">Control Systems with Sympy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Digital PID Control - Part 2</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="digital-pid-control-part-2">
<h1>Digital PID Control - Part 2<a class="headerlink" href="#digital-pid-control-part-2" title="Link to this heading">¶</a></h1>
<p><img alt="" src="_images/p19.png" /></p>
<p>In this section, we will – part-by-part – derive the integral and derivative terms of a PID control. We will use <strong>backward Euler, forward Euler, and bilinear transformation</strong> for the discretization.</p>
<section id="required-imports">
<h2>Required Imports<a class="headerlink" href="#required-imports" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mathprint</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="preparations">
<h2>Preparations<a class="headerlink" href="#preparations" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Kp</span><span class="p">,</span> <span class="n">Ki</span><span class="p">,</span> <span class="n">Kd</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;K_p K_i K_d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Ts</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;T_s N&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">s</span>  <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">z</span>  <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

<span class="n">e</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;e P I D&#39;</span><span class="p">)</span>
<span class="n">e1p</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;e_{k+1} e_k e_{k-1} e_{k-2}&#39;</span><span class="p">)</span>
<span class="n">I1p</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;I_{k+1} I_k I_{k-1} I_{k-2}&#39;</span><span class="p">)</span>
<span class="n">D1p</span><span class="p">,</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;D_{k+1} D_k D_{k-1} D_{k-2}&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-three-transformations">
<h2>The Three Transformations<a class="headerlink" href="#the-three-transformations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FE</span></code> for Forward Euler (ZOH)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BE</span></code> for Backward Euler (ZOH)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BT</span></code> for Bilinear Transformation (Tustin)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FE</span> <span class="o">=</span> <span class="n">Ts</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">BE</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">Ts</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">BT</span> <span class="o">=</span> <span class="n">Ts</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="integral-control-action">
<h2>Integral Control Action<a class="headerlink" href="#integral-control-action" title="Link to this heading">¶</a></h2>
<p>Let us set <span class="math notranslate nohighlight">\(G_I\)</span> as the integral control transfer funcion and <span class="math notranslate nohighlight">\(K_i\)</span> as the gain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GI</span> <span class="o">=</span> <span class="n">Ki</span><span class="o">/</span><span class="n">s</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;G_I(s)= &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">GI</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle G_I(s)= \frac{K_{i}}{s}\]</div>
</div>
</div>
<section id="with-backward-euler">
<h3><u>With Backward Euler</u><a class="headerlink" href="#with-backward-euler" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(I\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GI</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">e1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">I1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">I0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">IBE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">Ts</span><span class="p">]),</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="p">[</span><span class="n">Ki</span><span class="p">])</span> <span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IBE</span><span class="p">))</span>

<span class="n">IBE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I1p</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">IBE</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IBE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle I = \frac{K_{i} T_{s} e z}{z - 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e z = I \left(z - 1\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e z = I z - I\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e_{k+1} = - I_{k} + I_{k+1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - I_{k} + I_{k+1} = K_{i} T_{s} e_{k+1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{I_{k+1} = I_{k} + K_{i} T_{s} e_{k+1}}\]</div>
</div>
</div>
</section>
<section id="with-forward-euler">
<h3><u>With Forward Euler</u><a class="headerlink" href="#with-forward-euler" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(I\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GI</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">FE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">e1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">I1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">I0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">IFE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">Ts</span><span class="p">]),</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="p">[</span><span class="n">Ki</span><span class="p">])</span> <span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IFE</span><span class="p">))</span>

<span class="n">IFE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I1p</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">IFE</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IFE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle I = \frac{K_{i} T_{s} e}{z - 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e = I \left(z - 1\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e = I z - I\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e_{k} = - I_{k} + I_{k+1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - I_{k} + I_{k+1} = K_{i} T_{s} e_{k}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{I_{k+1} = I_{k} + K_{i} T_{s} e_{k}}\]</div>
</div>
</div>
</section>
<section id="with-bilinear-transformation">
<h3><u>With Bilinear Transformation</u><a class="headerlink" href="#with-bilinear-transformation" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(I\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GI</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BT</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">e1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">I1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">I0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">IBT</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I1p</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">I1p</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IBT</span><span class="p">))</span>

<span class="n">IBT</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">I1p</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">IBT</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Ki</span><span class="o">*</span><span class="n">Ts</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">IBT</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle I = \frac{K_{i} T_{s} e \left(z + 1\right)}{2 \left(z - 1\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} T_{s} e \left(z + 1\right) = I \left(2 z - 2\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} e z + K_{i} e = \frac{2 I z}{T_{s}} - \frac{2 I}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{i} e_{k} + K_{i} e_{k+1} = - \frac{2 I_{k}}{T_{s}} + \frac{2 I_{k+1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle I_{k+1} = I_{k} + \frac{K_{i} T_{s} e_{k}}{2} + \frac{K_{i} T_{s} e_{k+1}}{2}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{I_{k+1} = I_{k} + \frac{K_{i} T_{s} \left(e_{k} + e_{k+1}\right)}{2}}\]</div>
</div>
</div>
</section>
</section>
<section id="differential-control-action">
<h2>Differential Control Action<a class="headerlink" href="#differential-control-action" title="Link to this heading">¶</a></h2>
<p>Let us set <span class="math notranslate nohighlight">\(G_D\)</span> as the integral control transfer funcion and <span class="math notranslate nohighlight">\(K_d\)</span> as the gain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GD</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">Kd</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;G_D(s)= &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">GD</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle G_D(s)= K_{d} s\]</div>
</div>
</div>
<section id="id1">
<h3><u>With Backward Euler</u><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GD</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DBE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">]),</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">Kd</span><span class="o">/</span><span class="n">Ts</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} e \left(z - 1\right)}{T_{s} z}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} e \left(z - 1\right)}{T_{s} z}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{d} e \left(z - 1\right) = D T_{s} z\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} e}{T_{s}} - \frac{K_{d} e}{T_{s} z} = D\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} e_{k}}{T_{s}} - \frac{K_{d} e_{k-1}}{T_{s}} = D_{k}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{K_{d} \left(e_{k} - e_{k-1}\right)}{T_{s}}}\]</div>
</div>
</div>
</section>
<section id="id2">
<h3><u>With Forward Euler</u><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GD</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">FE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">e1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DFE</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Kd</span><span class="o">/</span><span class="n">Ts</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DFE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} e \left(z - 1\right)}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D_{k} = - \frac{K_{d} e_{k}}{T_{s}} + \frac{K_{d} e_{k+1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{K_{d} \left(- e_{k} + e_{k+1}\right)}{T_{s}}}\]</div>
</div>
</div>
</section>
<section id="id3">
<h3><u>With Bilinear Transformation</u><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GD</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BT</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DBT</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">D0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBT</span><span class="p">))</span>

<span class="n">DBT</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">DBT</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Kd</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBT</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{2 K_{d} e \left(z - 1\right)}{T_{s} \left(z + 1\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{2 K_{d} e \left(z - 1\right)}{T_{s} \left(z + 1\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 2 K_{d} e \left(z - 1\right) = D T_{s} \left(z + 1\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{2 K_{d} e}{T_{s}} - \frac{2 K_{d} e}{T_{s} z} = D + \frac{D}{z}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{2 K_{d} e_{k}}{T_{s}} - \frac{2 K_{d} e_{k-1}}{T_{s}} = D_{k} + D_{k-1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D_{k} = \frac{- D_{k-1} T_{s} + 2 K_{d} e_{k} - 2 K_{d} e_{k-1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{- D_{k-1} T_{s} + 2 K_{d} \left(e_{k} - e_{k-1}\right)}{T_{s}}}\]</div>
</div>
</div>
</section>
</section>
<section id="differential-control-action-with-derivative-filter">
<h2>Differential Control Action with Derivative Filter<a class="headerlink" href="#differential-control-action-with-derivative-filter" title="Link to this heading">¶</a></h2>
<p>Let us set <span class="math notranslate nohighlight">\(G_D\)</span> as the integral control transfer funcion, <span class="math notranslate nohighlight">\(K_d\)</span> as the gain and <span class="math notranslate nohighlight">\(1/N\)</span> as the filter time-constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GDF</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">Kd</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;G_D(s)= &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">GD</span><span class="p">))</span>

<span class="n">GDF</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">GDF</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;G_D(s)= &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">GD</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle G_D(s)= K_{d} s\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle G_D(s)= K_{d} s\]</div>
</div>
</div>
<section id="id4">
<h3><u>With Backward Euler</u><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GDF</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DBEF</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">]),</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">Kd</span><span class="o">/</span><span class="n">Ts</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBEF</span><span class="p">))</span>

<span class="n">DBEF</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">DBEF</span><span class="p">,</span> <span class="n">D0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Kd</span><span class="o">*</span><span class="n">N</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBEF</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} N e \left(z - 1\right)}{T_{s} z \left(N + \frac{z - 1}{T_{s} z}\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} N e \left(z - 1\right)}{N T_{s} z + z - 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{d} N e \left(z - 1\right) = D \left(N T_{s} z + z - 1\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} N e}{T_{s}} - \frac{K_{d} N e}{T_{s} z} = D N + \frac{D}{T_{s}} - \frac{D}{T_{s} z}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} N e_{k}}{T_{s}} - \frac{K_{d} N e_{k-1}}{T_{s}} = D_{k} N + \frac{D_{k}}{T_{s}} - \frac{D_{k-1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D_{k} \left(N + \frac{1}{T_{s}}\right) - \frac{D_{k-1}}{T_{s}} = \frac{K_{d} N \left(e_{k} - e_{k-1}\right)}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{D_{k-1} + K_{d} N \left(e_{k} - e_{k-1}\right)}{N T_{s} + 1}}\]</div>
</div>
</div>
</section>
<section id="id5">
<h3><u>With Forward Euler</u><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GDF</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">FE</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">e1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">D1p</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DFEF</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">]),</span> <span class="n">collect</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">Kd</span><span class="o">*</span><span class="n">N</span><span class="o">/</span><span class="n">Ts</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DFEF</span><span class="p">))</span>

<span class="n">DFEF</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">DFEF</span><span class="p">,</span> <span class="n">D0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">Kd</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">D1</span><span class="p">]))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DFEF</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} N e \left(z - 1\right)}{T_{s} \left(N + \frac{z - 1}{T_{s}}\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{K_{d} N e \left(z - 1\right)}{N T_{s} + z - 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle K_{d} N e \left(z - 1\right) = D \left(N T_{s} + z - 1\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} N e z}{T_{s}} - \frac{K_{d} N e}{T_{s}} = D N + \frac{D z}{T_{s}} - \frac{D}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{K_{d} N e_{k}}{T_{s}} + \frac{K_{d} N e_{k+1}}{T_{s}} = D_{k} N - \frac{D_{k}}{T_{s}} + \frac{D_{k+1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D_{k} \left(N - \frac{1}{T_{s}}\right) + \frac{D_{k+1}}{T_{s}} = \frac{K_{d} N \left(- e_{k} + e_{k+1}\right)}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{- D_{k+1} + K_{d} N \left(- e_{k} + e_{k+1}\right)}{N T_{s} - 1}}\]</div>
</div>
</div>
</section>
<section id="id6">
<h3><u>With Bilinear Transformation</u><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>Let us set <span class="math notranslate nohighlight">\(e\)</span> as the control input and <span class="math notranslate nohighlight">\(D\)</span> as the control output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">GDF</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">BT</span><span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">eq</span><span class="o">.</span><span class="n">lhs</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">lhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span><span class="p">,</span> <span class="n">eq</span><span class="o">.</span><span class="n">rhs</span><span class="o">/</span><span class="n">z</span><span class="o">/</span><span class="n">Ts</span> <span class="p">))</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">D1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">D0</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">eq</span><span class="p">))</span>

<span class="n">DBTF</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">collect</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">D0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">Kd</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">D1</span><span class="p">]))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">DBTF</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{2 K_{d} N e \left(z - 1\right)}{T_{s} \left(N + \frac{2 \left(z - 1\right)}{T_{s} \left(z + 1\right)}\right) \left(z + 1\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle D = \frac{2 K_{d} N e \left(z - 1\right)}{N T_{s} z + N T_{s} + 2 z - 2}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 2 K_{d} N e \left(z - 1\right) = D \left(N T_{s} z + N T_{s} + 2 z - 2\right)\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{2 K_{d} N e}{T_{s}} - \frac{2 K_{d} N e}{T_{s} z} = D N + \frac{D N}{z} + \frac{2 D}{T_{s}} - \frac{2 D}{T_{s} z}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{2 K_{d} N e_{k}}{T_{s}} - \frac{2 K_{d} N e_{k-1}}{T_{s}} = D_{k} N + \frac{2 D_{k}}{T_{s}} + D_{k-1} N - \frac{2 D_{k-1}}{T_{s}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{D_{k} = \frac{D_{k-1} \left(- N T_{s} + 2\right) + 2 K_{d} N \left(e_{k} - e_{k-1}\right)}{N T_{s} + 2}}\]</div>
</div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<section id="integral-terms">
<h3><u>Integral Terms</u><a class="headerlink" href="#integral-terms" title="Link to this heading">¶</a></h3>
<p>Let us summarize the integral terms. Note that the backward Euler method and the bilinear transform method result in implicit-form equations.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span>

<span class="k">def</span> <span class="nf">makelatex</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    
<span class="n">descs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Backward Euler&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;Forward Euler&quot;</span><span class="p">,</span>
         <span class="s2">&quot;Bilinear Transform&quot;</span><span class="p">]</span>

<span class="n">vals</span>  <span class="o">=</span> <span class="p">[</span><span class="n">IBE</span><span class="p">,</span> <span class="n">IFE</span><span class="p">,</span> <span class="n">IBT</span><span class="p">]</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="n">descs</span><span class="p">,</span> 
       <span class="s1">&#39;Integral term&#39;</span><span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">vals</span><span class="p">),}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Method</p></th>
<th class="head text-left"><p>Integral term</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Backward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(I_{k+1} = I_{k} + K_{i} T_{s} e_{k+1}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Forward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(I_{k+1} = I_{k} + K_{i} T_{s} e_{k}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Bilinear Transform</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(I_{k+1} = I_{k} + \frac{K_{i} T_{s} \left(e_{k} + e_{k+1}\right)}{2}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="derivative-terms">
<h3><u>Derivative Terms</u><a class="headerlink" href="#derivative-terms" title="Link to this heading">¶</a></h3>
<p>Let us summarize the derivative terms. Note that forward Euler results in non-causal equation.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">descs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Backward Euler&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;Forward Euler&quot;</span><span class="p">,</span>
         <span class="s2">&quot;Bilinear Transform&quot;</span><span class="p">]</span>

<span class="n">vals</span>  <span class="o">=</span> <span class="p">[</span><span class="n">DBE</span><span class="p">,</span> <span class="n">DFE</span><span class="p">,</span> <span class="n">DBT</span><span class="p">]</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="n">descs</span><span class="p">,</span> 
       <span class="s1">&#39;Derivative term&#39;</span><span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">vals</span><span class="p">),}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Method</p></th>
<th class="head text-left"><p>Derivative term</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Backward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{K_{d} \left(e_{k} - e_{k-1}\right)}{T_{s}}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Forward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{K_{d} \left(- e_{k} + e_{k+1}\right)}{T_{s}}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Bilinear Transform</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{- D_{k-1} T_{s} + 2 K_{d} \left(e_{k} - e_{k-1}\right)}{T_{s}}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="derivative-terms-with-low-pass-filters">
<h3><u>Derivative Terms with Low-Pass Filters</u><a class="headerlink" href="#derivative-terms-with-low-pass-filters" title="Link to this heading">¶</a></h3>
<p>Let us summarize the filtered derivative terms. Note that forward Euler also results in non-causal equation.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">descs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Backward Euler&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;Forward Euler&quot;</span><span class="p">,</span>
         <span class="s2">&quot;Bilinear Transform&quot;</span><span class="p">]</span>

<span class="n">vals</span>  <span class="o">=</span> <span class="p">[</span><span class="n">DBEF</span><span class="p">,</span> <span class="n">DFEF</span><span class="p">,</span> <span class="n">DBTF</span><span class="p">]</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="n">descs</span><span class="p">,</span> 
       <span class="s1">&#39;Derivative term + low-pass filter&#39;</span><span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">vals</span><span class="p">),}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Method</p></th>
<th class="head text-left"><p>Derivative term + low-pass filter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Backward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{D_{k-1} + K_{d} N \left(e_{k} - e_{k-1}\right)}{N T_{s} + 1}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Forward Euler</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{- D_{k+1} + K_{d} N \left(- e_{k} + e_{k+1}\right)}{N T_{s} - 1}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Bilinear Transform</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(D_{k} = \frac{D_{k-1} \left(- N T_{s} + 2\right) + 2 K_{d} N \left(e_{k} - e_{k-1}\right)}{N T_{s} + 2}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "py.3.12.4"
        },
        kernelOptions: {
            name: "py.3.12.4",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'py.3.12.4'</script>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="intro.html">
              <img class="logo" src="_static/logo.png" alt="Logo of Project name not set"/>
            </a></p>
  <div>
    <h3><a href="intro.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Digital PID Control - Part 2</a><ul>
<li><a class="reference internal" href="#required-imports">Required Imports</a></li>
<li><a class="reference internal" href="#preparations">Preparations</a></li>
<li><a class="reference internal" href="#the-three-transformations">The Three Transformations</a></li>
<li><a class="reference internal" href="#integral-control-action">Integral Control Action</a><ul>
<li><a class="reference internal" href="#with-backward-euler"><u>With Backward Euler</u></a></li>
<li><a class="reference internal" href="#with-forward-euler"><u>With Forward Euler</u></a></li>
<li><a class="reference internal" href="#with-bilinear-transformation"><u>With Bilinear Transformation</u></a></li>
</ul>
</li>
<li><a class="reference internal" href="#differential-control-action">Differential Control Action</a><ul>
<li><a class="reference internal" href="#id1"><u>With Backward Euler</u></a></li>
<li><a class="reference internal" href="#id2"><u>With Forward Euler</u></a></li>
<li><a class="reference internal" href="#id3"><u>With Bilinear Transformation</u></a></li>
</ul>
</li>
<li><a class="reference internal" href="#differential-control-action-with-derivative-filter">Differential Control Action with Derivative Filter</a><ul>
<li><a class="reference internal" href="#id4"><u>With Backward Euler</u></a></li>
<li><a class="reference internal" href="#id5"><u>With Forward Euler</u></a></li>
<li><a class="reference internal" href="#id6"><u>With Bilinear Transformation</u></a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">Summary</a><ul>
<li><a class="reference internal" href="#integral-terms"><u>Integral Terms</u></a></li>
<li><a class="reference internal" href="#derivative-terms"><u>Derivative Terms</u></a></li>
<li><a class="reference internal" href="#derivative-terms-with-low-pass-filters"><u>Derivative Terms with Low-Pass Filters</u></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="digital-pid.html"
                          title="previous chapter">Digital PID Control - Part 1</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="digital-filter.html"
                          title="next chapter">Digital Low-Pass Filter</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/digital-pid-2.ipynb"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="digital-filter.html" title="Digital Low-Pass Filter"
             >next</a> |</li>
        <li class="right" >
          <a href="digital-pid.html" title="Digital PID Control - Part 1"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="intro.html">Control Systems with Sympy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Digital PID Control - Part 2</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>