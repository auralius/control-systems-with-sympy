<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>First-order system and PID-control &#8212; Control Systems with Sympy</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/traditional.css?v=608ddc6c" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"HTML-CSS": {"matchFontHeight": true, "scale": 50}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Digital PID Control - Part 1" href="digital-pid.html" />
    <link rel="prev" title="Gain Margin and Phase Margin" href="bode-margins.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="digital-pid.html" title="Digital PID Control - Part 1"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bode-margins.html" title="Gain Margin and Phase Margin"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="intro.html">Control Systems with Sympy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">First-order system and PID-control</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="first-order-system-and-pid-control">
<h1>First-order system and PID-control<a class="headerlink" href="#first-order-system-and-pid-control" title="Link to this heading">¶</a></h1>
<section id="preparations">
<h2>Preparations<a class="headerlink" href="#preparations" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="s2">&quot;text.usetex&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;font.family&quot;</span><span class="p">:</span> <span class="s2">&quot;Helvetica&quot;</span><span class="p">,</span>
        <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">})</span>
    
    <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">sympy.plotting</span> <span class="kn">import</span> <span class="n">plot</span>
    
    <span class="kn">from</span> <span class="nn">mathprint</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.physics.control.lti</span> <span class="kn">import</span> <span class="n">TransferFunction</span>
<span class="n">Kp</span><span class="p">,</span> <span class="n">Ki</span><span class="p">,</span> <span class="n">Kd</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;K_p K_i K_d&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t</span>       <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">s</span>       <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tau</span>     <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">omega</span>   <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;omega&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">omega_n</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;omega_n&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">zeta</span>    <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;zeta&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">laplace_transform</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">noconds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">F</span>

<span class="k">def</span> <span class="nf">ilaplace</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">inverse_laplace_transform</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="k">def</span> <span class="nf">frac_to_tf</span><span class="p">(</span><span class="n">frac</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">TransferFunction</span><span class="p">(</span><span class="n">fraction</span><span class="p">(</span><span class="n">frac</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fraction</span><span class="p">(</span><span class="n">frac</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="system-and-the-control-equations">
<h2>System and the control equations<a class="headerlink" href="#system-and-the-control-equations" title="Link to this heading">¶</a></h2>
<p><img alt="" src="_images/p13.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">tau</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Kp</span> <span class="o">+</span> <span class="n">Ki</span><span class="o">/</span><span class="n">s</span> <span class="o">+</span> <span class="n">Kd</span><span class="o">*</span><span class="n">s</span>   <span class="c1"># PID-control</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(((</span><span class="n">G</span><span class="o">*</span><span class="n">H</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="o">*</span><span class="n">H</span><span class="p">))))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;first-order system:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;H(s)=&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PID-control:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;G(s)= &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the resulting closed-loop system:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="s2">&quot;Q(s)=&quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>first-order system:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle H(s)=\frac{1}{s \tau + 1}\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PID-control:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle G(s)= K_{d} s + \frac{K_{i}}{s} + K_{p}\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the resulting closed-loop system:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle Q(s)=\frac{K_{d} s^{2} + K_{i} + K_{p} s}{K_{d} s^{2} + K_{i} + K_{p} s + s^{2} \tau + s}\]</div>
</div>
</div>
</section>
<section id="first-order-system-with-p-control">
<h2>First order system with P-control<a class="headerlink" href="#first-order-system-with-p-control" title="Link to this heading">¶</a></h2>
<p>Closed-loop transfer function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qp</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">subs</span><span class="p">(([</span><span class="n">Kd</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="n">Ki</span><span class="p">,</span> <span class="mi">0</span><span class="p">])))</span>

<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">Qp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{p}}{K_{p} + s \tau + 1}\]</div>
</div>
</div>
<p>The controlled system remains a first order system. <span class="math notranslate nohighlight">\(K_p\)</span> changes the pole location.
New pole location:</p>
<section id="closed-loop-poles-and-zeros">
<h3>Closed-loop poles and zeros<a class="headerlink" href="#closed-loop-poles-and-zeros" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">frac_to_tf</span><span class="p">(</span><span class="n">Qp</span><span class="p">)</span>
<span class="n">zerosp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">zeros</span><span class="p">()</span>
<span class="n">polesp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">poles</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">zerosp</span><span class="p">))</span>
       
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop poles:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">polesp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ \right]\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop poles:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p} + 1}{\tau}\right]\]</div>
</div>
</div>
</section>
<section id="step-response">
<h3>Step response<a class="headerlink" href="#step-response" title="Link to this heading">¶</a></h3>
<p>Let us define some numerical values for our simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Kp_</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We simply perform an inverse Laplace operation to <span class="math notranslate nohighlight">\(C(s)\)</span> and obtain <span class="math notranslate nohighlight">\(c(t)\)</span> as the result. Additionally, we will also compute the steady state-value for the output (<span class="math notranslate nohighlight">\(c_{ss}\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">=</span> <span class="n">ilaplace</span><span class="p">(</span><span class="n">Qp</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>

<span class="n">cssp</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">limit</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">))</span>
<span class="n">c0p</span>  <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(t) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{ss}</span><span class="s2"> = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">cssp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(t) = K_{p} \left(- \frac{\tau e^{- \frac{t \left(K_{p}^{2} + 2 K_{p} + 1\right)}{K_{p} \tau + \tau}}}{K_{p} \tau + \tau} + \frac{1}{K_{p} + 1}\right)}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c_{ss} = \frac{K_{p}}{K_{p} + 1}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">subs</span><span class="p">(([</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_</span><span class="p">],</span> <span class="p">[</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">[</span><span class="n">j</span><span class="p">]])),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$c(t)$&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Kp_</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$K_p=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Kp_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;$&quot;</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/20c83d98fb7d5d63d07a954de87099cdd67e2f806035307d8b2f281bb2c45b98.png" src="_images/20c83d98fb7d5d63d07a954de87099cdd67e2f806035307d8b2f281bb2c45b98.png" />
</div>
</div>
</section>
</section>
<section id="first-order-system-with-pd-control">
<h2>First-order system with PD-control<a class="headerlink" href="#first-order-system-with-pd-control" title="Link to this heading">¶</a></h2>
<p>Closed-loop transfer function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qpd</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">Qpd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{K_{d} s + K_{p}}{K_{d} s + K_{p} + s \tau + 1}\]</div>
</div>
</div>
<section id="id1">
<h3>Closed-loop poles and zeros<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">frac_to_tf</span><span class="p">(</span><span class="n">Qpd</span><span class="p">)</span>
<span class="n">zerospd</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">zeros</span><span class="p">()</span>
<span class="n">polespd</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">poles</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">zerospd</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">polespd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p}}{K_{d}}\right]\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p} + 1}{K_{d} + \tau}\right]\]</div>
</div>
</div>
</section>
<section id="id2">
<h3>Step response<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>We simply perform an inverse Laplace operation to <span class="math notranslate nohighlight">\(C(s)\)</span> and obtain <span class="math notranslate nohighlight">\(c(t)\)</span> as the result. Additionally, we will also compute the steady state-value for the output (<span class="math notranslate nohighlight">\(c_{ss}\)</span>).</p>
<p>A phenomenon that can be observed in a derivative control is the “kick” that happens when a step input is applied to the controlled system. Because of the kick, system output does not start from zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpd</span>   <span class="o">=</span> <span class="n">logcombine</span><span class="p">(</span><span class="n">ilaplace</span><span class="p">(</span><span class="n">Qpd</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">))</span>
<span class="n">csspd</span> <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cpd</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">)</span>
<span class="n">c0pd</span>  <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cpd</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(t) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">cpd</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{ss}</span><span class="s2"> = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">csspd</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(0) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">c0pd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(t) = \frac{K_{p}}{K_{p} + 1} + \frac{\left(K_{d} - K_{p} \tau\right) e^{- \frac{t \left(K_{p}^{2} + 2 K_{p} + 1\right)}{K_{d} K_{p} + K_{d} + K_{p} \tau + \tau}}}{K_{d} K_{p} + K_{d} + K_{p} \tau + \tau}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c_{ss} = \frac{K_{p}}{K_{p} + 1}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(0) = \frac{K_{d}}{K_{d} + \tau}}\]</div>
</div>
</div>
<p>Next, we set up arbitrary numerical values to some parameters and run sumulate the controlled system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Kp_</span>  <span class="o">=</span> <span class="mi">20</span>
<span class="n">Kd_</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">cpd</span><span class="o">.</span><span class="n">subs</span><span class="p">(([</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_</span><span class="p">],</span> <span class="p">[</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">],[</span><span class="n">Kd</span><span class="p">,</span> <span class="n">Kd_</span><span class="p">[</span><span class="n">j</span><span class="p">]])),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$c(t)$&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis_center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Kd_</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$K_d=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Kd_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;$&quot;</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">csspd</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$ c_</span><span class="si">{ss}</span><span class="s2"> (t) = &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">csspd</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; $&quot;</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94e62a753e91bdbca9625ca948bcefde152c05a14cfc292aaa5073e27c1a9182.png" src="_images/94e62a753e91bdbca9625ca948bcefde152c05a14cfc292aaa5073e27c1a9182.png" />
</div>
</div>
</section>
</section>
<section id="first-order-system-with-pi-control">
<h2>First-order system with PI-control<a class="headerlink" href="#first-order-system-with-pi-control" title="Link to this heading">¶</a></h2>
<p>Closed-loop transfer function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Qpi</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Kd</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">mprintb</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">Qpi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{\frac{K_{i} + K_{p} s}{K_{i} + K_{p} s + s^{2} \tau + s}}\]</div>
</div>
</div>
<section id="id3">
<h3>Closed-loop poles and zeros<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">frac_to_tf</span><span class="p">(</span><span class="n">Qpi</span><span class="p">)</span>
<span class="n">zerospi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">zeros</span><span class="p">()</span>
<span class="n">polespi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">poles</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">zerospi</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">polespi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{i}}{K_{p}}\right]\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p} + 1}{2 \tau} - \frac{\sqrt{- 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \tau}, \  - \frac{K_{p} + 1}{2 \tau} + \frac{\sqrt{- 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \tau}\right]\]</div>
</div>
</div>
</section>
<section id="id4">
<h3>Step response<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>We simply perform an inverse Laplace operation to <span class="math notranslate nohighlight">\(C(s)\)</span> and obtain <span class="math notranslate nohighlight">\(c(t)\)</span> as the result. Additionally, we will also compute the steady state-value for the output (<span class="math notranslate nohighlight">\(c_{ss}\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi</span> <span class="o">=</span> <span class="n">ilaplace</span><span class="p">(</span><span class="n">Qpi</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="n">cpi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">simplify</span><span class="p">(</span><span class="n">cpi</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cpi</span><span class="o">.</span><span class="n">args</span><span class="p">))])</span>

<span class="n">csspi</span> <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cpi</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">)</span>

<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(t) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">cpi</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{ss}</span><span class="s2"> = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">csspi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(t) = \frac{\left(K_{p} - 1\right) e^{- \frac{t \left(K_{p} + 1\right)}{2 \tau}} \sin{\left(\frac{t \sqrt{4 K_{i} \tau - K_{p}^{2} - 2 K_{p} - 1}}{2 \tau} \right)}}{\sqrt{4 K_{i} \tau - K_{p}^{2} - 2 K_{p} - 1}} + 1 - e^{- \frac{t \left(K_{p} + 1\right)}{2 \tau}} \cos{\left(\frac{t \sqrt{4 K_{i} \tau - K_{p}^{2} - 2 K_{p} - 1}}{2 \tau} \right)}}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c_{ss} = 1}\]</div>
</div>
</div>
<p>Next, we set up arbitrary numerical values to some parameters and run sumulate the controlled system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Kp_</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">Ki_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">Kd_</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">cpi</span><span class="o">.</span><span class="n">subs</span><span class="p">(([</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_</span><span class="p">],</span> <span class="p">[</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">],[</span><span class="n">Ki</span><span class="p">,</span> <span class="n">Ki_</span><span class="p">[</span><span class="n">j</span><span class="p">]])),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$c(t)$&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ki_</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$K_i=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ki_</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;$&quot;</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">csspi</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$ c_</span><span class="si">{ss}</span><span class="s2"> (t) = &quot;</span> <span class="o">+</span> <span class="n">latex</span><span class="p">(</span><span class="n">csspi</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp_</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; $&quot;</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/108ad764a1168ac493d87ff1a88a402262ecab01934709eb0d9a0ec531c63f5a.png" src="_images/108ad764a1168ac493d87ff1a88a402262ecab01934709eb0d9a0ec531c63f5a.png" />
</div>
</div>
</section>
<section id="first-order-system-with-pid-control">
<h3>First-order system with PID-control<a class="headerlink" href="#first-order-system-with-pid-control" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">frac_to_tf</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">zerospid</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">zeros</span><span class="p">()</span>
<span class="n">polespid</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">poles</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop zeros:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">zerospid</span><span class="p">))</span>
       
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;closed-loop poles:&quot;</span><span class="p">)</span>
<span class="n">mprint</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">polespid</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop zeros:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p}}{2 K_{d}} - \frac{\sqrt{- 4 K_{d} K_{i} + K_{p}^{2}}}{2 K_{d}}, \  - \frac{K_{p}}{2 K_{d}} + \frac{\sqrt{- 4 K_{d} K_{i} + K_{p}^{2}}}{2 K_{d}}\right]\]</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closed-loop poles:
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[ - \frac{K_{p} + 1}{2 \left(K_{d} + \tau\right)} - \frac{\sqrt{- 4 K_{d} K_{i} - 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \left(K_{d} + \tau\right)}, \  - \frac{K_{p} + 1}{2 \left(K_{d} + \tau\right)} + \frac{\sqrt{- 4 K_{d} K_{i} - 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \left(K_{d} + \tau\right)}\right]\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpid</span>   <span class="o">=</span> <span class="n">logcombine</span><span class="p">(</span><span class="n">ilaplace</span><span class="p">(</span><span class="n">Q</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">))</span>
<span class="n">csspid</span> <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cpid</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">)</span>
<span class="n">c0pid</span>  <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="n">cpid</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(t) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">cpid</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c_</span><span class="si">{ss}</span><span class="s2"> = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">csspid</span><span class="p">))</span>
<span class="n">mprintb</span><span class="p">(</span><span class="s2">&quot;c(0) = &quot;</span><span class="p">,</span> <span class="n">latex</span><span class="p">(</span><span class="n">c0pid</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(t) = - \frac{\tau e^{- \frac{t \left(K_{p} + 1\right)}{2 \left(K_{d} + \tau\right)}} \cos{\left(\frac{t \sqrt{K_{d} K_{i} + K_{i} \tau - \frac{K_{p}^{2}}{4} - \frac{K_{p}}{2} - \frac{1}{4}}}{K_{d} + \tau} \right)}}{K_{d} + \tau} + \frac{2 \left(K_{d} + \tau\right) \left(\frac{\tau \left(K_{p} + 1\right)}{2 \left(K_{d} + \tau\right)^{2}} - \frac{1}{K_{d} + \tau}\right) e^{- \frac{t \left(K_{p} + 1\right)}{2 \left(K_{d} + \tau\right)}} \sin{\left(\frac{t \sqrt{4 K_{d} K_{i} + 4 K_{i} \tau - K_{p}^{2} - 2 K_{p} - 1}}{2 \left(K_{d} + \tau\right)} \right)}}{\sqrt{4 K_{d} K_{i} + 4 K_{i} \tau - K_{p}^{2} - 2 K_{p} - 1}} + 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c_{ss} = 1}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \boxed{c(0) = \frac{K_{d}}{K_{d} + \tau}}\]</div>
</div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<div class="cell tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">set_option</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span>

<span class="k">def</span> <span class="nf">makelatex</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

<span class="n">descs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> 
         <span class="s2">&quot;PD&quot;</span><span class="p">,</span>
         <span class="s2">&quot;PI&quot;</span><span class="p">,</span>
         <span class="s2">&quot;PID&quot;</span><span class="p">]</span>

<span class="n">css_label</span> <span class="o">=</span> <span class="p">[</span><span class="n">cssp</span><span class="p">,</span> <span class="n">csspd</span><span class="p">,</span> <span class="n">csspi</span><span class="p">,</span> <span class="n">csspid</span><span class="p">]</span>
<span class="n">c_label</span>   <span class="o">=</span> <span class="p">[</span><span class="n">cp</span><span class="p">,</span> <span class="n">cpd</span><span class="p">,</span> <span class="n">cpi</span><span class="p">,</span> <span class="n">cpid</span><span class="p">]</span>
<span class="n">cl_zeros</span>  <span class="o">=</span> <span class="p">[</span><span class="n">zerosp</span><span class="p">,</span> <span class="n">zerospd</span><span class="p">,</span> <span class="n">zerospi</span><span class="p">,</span> <span class="n">zerospid</span><span class="p">]</span>
<span class="n">cl_poles</span>  <span class="o">=</span> <span class="p">[</span><span class="n">polesp</span><span class="p">,</span> <span class="n">polespd</span><span class="p">,</span> <span class="n">polespi</span><span class="p">,</span> <span class="n">polespid</span><span class="p">]</span>
<span class="n">kicks</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c0pd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c0pid</span><span class="p">]</span>


<span class="n">dic1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;&#39;</span>         <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">descs</span><span class="p">),</span> 
        <span class="s1">&#39;$c_</span><span class="si">{ss}</span><span class="s1">$&#39;</span> <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">css_label</span><span class="p">),</span>
        <span class="s1">&#39;$c(0)$&#39;</span>   <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">kicks</span><span class="p">)}</span>

<span class="n">dic2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;&#39;</span>         <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">descs</span><span class="p">),</span> 
        <span class="s1">&#39;Zeros&#39;</span>    <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">cl_zeros</span><span class="p">),</span>
        <span class="s1">&#39;Poles&#39;</span>    <span class="p">:</span> <span class="n">makelatex</span><span class="p">(</span><span class="n">cl_poles</span><span class="p">)}</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dic1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dic2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="initial-and-steady-state-output-for-unit-step-input">
<h3>Initial and steady-state output for unit-step input<a class="headerlink" href="#initial-and-steady-state-output-for-unit-step-input" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Markdown</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(c_{ss}\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(c(0)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{P}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\frac{K_{p}}{K_{p} + 1}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PD}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\frac{K_{p}}{K_{p} + 1}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\frac{K_{d}}{K_{d} + \tau}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PI}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PID}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\frac{K_{d}}{K_{d} + \tau}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="zeros-and-poles">
<h3>Zeros and poles<a class="headerlink" href="#zeros-and-poles" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Markdown</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p>Zeros</p></th>
<th class="head text-left"><p>Poles</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{P}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ \right]\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p} + 1}{\tau}\right]\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PD}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p}}{K_{d}}\right]\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p} + 1}{K_{d} + \tau}\right]\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PI}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{i}}{K_{p}}\right]\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p} + 1}{2 \tau} - \frac{\sqrt{- 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \tau}, \  - \frac{K_{p} + 1}{2 \tau} + \frac{\sqrt{- 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \tau}\right]\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\mathtt{\text{PID}}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p}}{2 K_{d}} - \frac{\sqrt{- 4 K_{d} K_{i} + K_{p}^{2}}}{2 K_{d}}, \  - \frac{K_{p}}{2 K_{d}} + \frac{\sqrt{- 4 K_{d} K_{i} + K_{p}^{2}}}{2 K_{d}}\right]\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left[ - \frac{K_{p} + 1}{2 \left(K_{d} + \tau\right)} - \frac{\sqrt{- 4 K_{d} K_{i} - 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \left(K_{d} + \tau\right)}, \  - \frac{K_{p} + 1}{2 \left(K_{d} + \tau\right)} + \frac{\sqrt{- 4 K_{d} K_{i} - 4 K_{i} \tau + K_{p}^{2} + 2 K_{p} + 1}}{2 \left(K_{d} + \tau\right)}\right]\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="intro.html">
              <img class="logo" src="_static/logo.png" alt="Logo of Project name not set"/>
            </a></p>
  <div>
    <h3><a href="intro.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">First-order system and PID-control</a><ul>
<li><a class="reference internal" href="#preparations">Preparations</a></li>
<li><a class="reference internal" href="#system-and-the-control-equations">System and the control equations</a></li>
<li><a class="reference internal" href="#first-order-system-with-p-control">First order system with P-control</a><ul>
<li><a class="reference internal" href="#closed-loop-poles-and-zeros">Closed-loop poles and zeros</a></li>
<li><a class="reference internal" href="#step-response">Step response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#first-order-system-with-pd-control">First-order system with PD-control</a><ul>
<li><a class="reference internal" href="#id1">Closed-loop poles and zeros</a></li>
<li><a class="reference internal" href="#id2">Step response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#first-order-system-with-pi-control">First-order system with PI-control</a><ul>
<li><a class="reference internal" href="#id3">Closed-loop poles and zeros</a></li>
<li><a class="reference internal" href="#id4">Step response</a></li>
<li><a class="reference internal" href="#first-order-system-with-pid-control">First-order system with PID-control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">Summary</a><ul>
<li><a class="reference internal" href="#initial-and-steady-state-output-for-unit-step-input">Initial and steady-state output for unit-step input</a></li>
<li><a class="reference internal" href="#zeros-and-poles">Zeros and poles</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="bode-margins.html"
                          title="previous chapter">Gain Margin and Phase Margin</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="digital-pid.html"
                          title="next chapter">Digital PID Control - Part 1</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pid-fo.ipynb"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="digital-pid.html" title="Digital PID Control - Part 1"
             >next</a> |</li>
        <li class="right" >
          <a href="bode-margins.html" title="Gain Margin and Phase Margin"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="intro.html">Control Systems with Sympy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">First-order system and PID-control</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>